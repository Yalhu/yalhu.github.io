<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="webpack,">





  <link rel="alternate" href="/atom.xml" title="Yalhu" type="application/atom+xml">






<meta name="description" content="2020.11.22 星期  ：   webpack-chainwebpack-chain: https://github.com/neutrinojs/webpack-chain/tree/v4 使用toString()查看chain对应的webpack配置   配置public path可以修改运行时路径 - 动态资源路径。webpack_public_path: https://webpa">
<meta name="keywords" content="webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack实践">
<meta property="og:url" content="http://yoursite.com/sum/jsplus/webpack实践/index.html">
<meta property="og:site_name" content="Yalhu">
<meta property="og:description" content="2020.11.22 星期  ：   webpack-chainwebpack-chain: https://github.com/neutrinojs/webpack-chain/tree/v4 使用toString()查看chain对应的webpack配置   配置public path可以修改运行时路径 - 动态资源路径。webpack_public_path: https://webpa">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2023-02-22T14:01:19.440Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Webpack实践">
<meta name="twitter:description" content="2020.11.22 星期  ：   webpack-chainwebpack-chain: https://github.com/neutrinojs/webpack-chain/tree/v4 使用toString()查看chain对应的webpack配置   配置public path可以修改运行时路径 - 动态资源路径。webpack_public_path: https://webpa">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/sum/jsplus/webpack实践/">





  <title>Webpack实践 | Yalhu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yalhu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">yalhu's blob</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/sum/jsplus/webpack实践/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yalhu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/robbot.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yalhu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Webpack实践</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-22T08:00:00+08:00">
                2020-11-22
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2023-02-22T22:01:19+08:00">
                2023-02-22
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sum/" itemprop="url" rel="index">
                    <span itemprop="name">sum</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sum/jsplus/" itemprop="url" rel="index">
                    <span itemprop="name">jsplus</span>
                  </a>
                </span>

                
                
              
            </span>
          
          
          
            
          

          
          
             <span id="/sum/jsplus/webpack实践/" class="leancloud_visitors" data-flag-title="Webpack实践">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,473
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p style="text-align:right"> 2020.11.22 星期  ： </p>

<h1 id="webpack-chain"><a href="#webpack-chain" class="headerlink" title="webpack-chain"></a>webpack-chain</h1><p>webpack-chain: <a href="https://github.com/neutrinojs/webpack-chain/tree/v4" target="_blank" rel="noopener">https://github.com/neutrinojs/webpack-chain/tree/v4</a></p>
<p>使用toString()查看chain对应的webpack配置<br><!-- `fs.writeFile('./config/webpack-config-start.js', chain.toString(), () => {})` --></p>
<!-- SS [webpack-chain 文档](https://drylint.com/Webpack/webpack-chain.html#介绍)
PS: webpack-chai 文档。介绍，每个配置的缩写等。 
 -->
<!-- 
[Webpack-chain 从入门到深入](https://juejin.cn/post/6947851867422621733)
\$_PS: 基础/教程。
[使用 webpack-chain 来创建 webpack 配置](https://juejin.cn/post/6866756948704886791)
\$_PS: 结合源码解析。
[前端工程：webpack-chain](http://www.zyiz.net/tech/detail-130942.html)
\$_PS: 常用配置，所有配置。
[vue-cli中webpack-chain的链式操作个人理解（解决90%的疑问）](https://blog.csdn.net/weixin_34384681/article/details/91369707)
`vue inspect module.rules`
 -->
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="public-path"><a href="#public-path" class="headerlink" title="public path"></a>public path</h2><p>可以修改运行时路径 - 动态资源路径。<br><strong>webpack_public_path</strong>: <a href="https://webpack.docschina.org/guides/public-path/" target="_blank" rel="noopener">https://webpack.docschina.org/guides/public-path/</a></p>
<p><a href="https://qiankun.umijs.org/zh/faq#a-使用-webpack-运行时-publicpath-配置" target="_blank" rel="noopener">qiankun.js: 使用 webpack 运行时 publicPath 配置</a></p>
<blockquote>
<p>runtime publicPath 主要解决的是微应用动态载入的 脚本、样式、图片 等地址不正确的问题。</p>
</blockquote>
<!-- 解决taro 项目动态引入的chunk。 -->
<!-- [动态修改webpack中的publicPath](https://juejin.cn/post/7004472324976017439) 
最近接到一个需求，比如项目本来的访问地址是 https://juejin.cn/pro/index.html,
现在要针对某个商户配置的访问地址是https://juejin.cn/pro/xxx/index.html, 多了一层上下文xxx,
代码都是同一套代码，只是后者会根据localtion.pathname做一个特定的主题配置，展示不同的风格。
所以问题就是怎么让https://juejin.cn/pro/xxx/index.html 指向
https://juejin.cn/pro/index.html。
-->
<blockquote>
<p>动态修改publicPath 只需要在入口文件顶一下<strong>webpack_require</strong>.p这个变量值即可，webpack在做ast解析的时候会特殊处理这个<strong>webpack_require</strong>这个变量，</p>
</blockquote>
<p>场景一：<br>静态资源都上传到oss。在webpack.config.js 文件中定义好publicPath 就没问题了。<br>但是taro项目/平台的云构建，并没有替换掉chunck 文件的路径。<br>所以，需要我们修改运行时public path;</p>
<p>场景二：<br>资源文件添加了域名兜底处理onrrror=”__reloadResource(this)”;<br>app.js 可以加载新域名。但是chunk 文件并没 添加onrrror（webpack-html-plugin）；<!-- 不用再加载发生问题的域名 -->直接加载兜底域名的资源就可以了。<br><!-- PS: 不要问为什么要加兜底域名。 --><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 兜底域名reload resouce 处理。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAsyncPublicPath</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log('get AsyncPublic Path', location)</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.TARO_ENV === <span class="string">"h5"</span> &amp;&amp; process.env.NODE_ENV === <span class="string">"production"</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> appjss = <span class="built_in">document</span>.querySelectorAll(<span class="string">"[src*='app.']"</span>);</span><br><span class="line">        <span class="keyword">if</span> (appjss.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            __webpack_public_path__ = <span class="string">"//jstatic2.3.cn/"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">getAsyncPublicPath();</span><br></pre></td></tr></table></figure></p>
<p>Note: 需要在app.js 的顶部引入。</p>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h3 id="terser-webpack-plugin"><a href="#terser-webpack-plugin" class="headerlink" title="terser-webpack-plugin"></a>terser-webpack-plugin</h3><ol start="0">
<li><code>chain.optimization.minimizer(&#39;terserPlugin&#39;)</code> 。</li>
<li>由于Webpack5已经集成terser-webpack-plugin，无需单独安装，直接引入</li>
<li>extractComments默认为true，所以会将注释提取到单独的文件中，生成LICENSE文件。<!-- Webpack5打包-禁止生成LICENSE文件 -->
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chain.plugin(<span class="string">"terserWebpackPlugin"</span>).use(<span class="keyword">new</span> TerserPlugin(&#123;</span><br><span class="line">    extractComments: <span class="literal">false</span>, <span class="comment">//不将注释提取到单独的文件中</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Whether comments shall be extracted to a separate file, (see details). By default extract only comments using /^\**!|@preserve|@license|@cc_on/i regexp condition and remove remaining comments. If the original file is named foo.js, then the comments will be stored to foo.js.LICENSE.txt. The terserOptions.format.comments option specifies whether the comment will be preserved, i.e. it is possible to preserve some comments (e.g. annotations) while extracting others or even preserving comments that have been extracted.</span><br></pre></td></tr></table></figure>
<h3 id="html-webpack-plugin"><a href="#html-webpack-plugin" class="headerlink" title="html-webpack-plugin"></a>html-webpack-plugin</h3><p>html-webpack-plugin: <a href="https://github.com/jantimon/html-webpack-plugin#options" target="_blank" rel="noopener">https://github.com/jantimon/html-webpack-plugin#options</a></p>
<ol>
<li>chain中使用 <code>chain.plugin(&quot;htmlWebpackPlugin&quot;)</code></li>
<li>单页应用需要生成多个html（url访问），可以添加多个插件实例。</li>
<li>filename 可以写路径，会把文件写到对应路径下面，比如<code>my/cart/main.shtml</code></li>
<li>在资源标签上添加onerror属性。<code>&lt;script src=&quot;//xxx.m.cn/js/app.8b9dbe4febbbf0233339.js&quot; onerror=&quot;__reloadResource(this)&quot;&gt;&lt;/script&gt;</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基于html-webpack-plugin。</span></span><br><span class="line"><span class="comment"> * 在资源标签上添加onerror属性。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HtmlAssetsReload</span> </span>&#123;</span><br><span class="line">    apply (compiler) &#123;</span><br><span class="line">      compiler.hooks.compilation.tap(<span class="string">'HtmlAssetsReload'</span>, (compilation) =&gt; &#123;</span><br><span class="line">        HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(<span class="string">"HtmlAssetsReload"</span>, (data, cb) =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span>  &#123;<span class="attr">assetTags</span>: &#123;scripts, styles&#125;&#125; = data;</span><br><span class="line">            <span class="comment">// console.log('HtmlAssetsReload:', scripts, styles)</span></span><br><span class="line">            scripts.forEach(<span class="function"><span class="params">v</span> =&gt;</span> v.attributes.onerror = <span class="string">"__reloadResource(this)"</span>)</span><br><span class="line">            styles.forEach(<span class="function"><span class="params">v</span> =&gt;</span> v.attributes.onerror = <span class="string">"__reloadResource(this)"</span>)</span><br><span class="line">            cb(<span class="literal">null</span>, data)</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = HtmlAssetsReload</span><br></pre></td></tr></table></figure>
</li>
</ol>
<!-- 
报错：`this.htmlWebpackPlugin.getHooks is not a function`
taro 构建的。需要指定/手动安装webpack `npm i --save-dev html-webpack-plugin@4`
同时手动指明html-webpack 插件；否则默认生成的html不会有上面属性。
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    h5: &#123;</span><br><span class="line">        publicPath: <span class="string">"//jstatic.3.cn/order/"</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">"./"</span>),</span><br><span class="line">        output: &#123;</span><br><span class="line">            filename: <span class="string">'js/[name].[hash].js'</span>,</span><br><span class="line">            chunkFilename: <span class="string">'js/[name].[chunkhash].js'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// imageUrlLoaderOption: &#123;</span></span><br><span class="line">        <span class="comment">//     limit: 5000,</span></span><br><span class="line">        <span class="comment">//     name: 'static/images/[name].[hash].[ext]'</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">        miniCssExtractPluginOption: &#123;</span><br><span class="line">            filename: <span class="string">'css/[name].[hash].css'</span>,</span><br><span class="line">            chunkFilename: <span class="string">'css/[name].[chunkhash].css'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        webpackChain (chain) &#123;</span><br><span class="line">            chain.plugin(<span class="string">"HtmlAssetsReload"</span>)</span><br><span class="line">                .use(<span class="keyword">new</span> HtmlAssetsReload());</span><br><span class="line">            chain.plugin(<span class="string">"HtmlWebpackPlugin"</span>)</span><br><span class="line">                .use(<span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">                    title: <span class="string">"订单"</span>,</span><br><span class="line">                    filename: <span class="string">"index.html"</span>,</span><br><span class="line">                    template: <span class="string">"src/index.html"</span>,</span><br><span class="line">                    minify: <span class="literal">false</span>,</span><br><span class="line">                &#125;))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 如果h5端编译后体积过大，可以使用webpack-bundle-analyzer插件对打包体积进行分析。</span></span><br><span class="line"><span class="comment">         * 参考代码如下：</span></span><br><span class="line"><span class="comment">         * webpackChain (chain) &#123;</span></span><br><span class="line"><span class="comment">         *   chain.plugin('analyzer')</span></span><br><span class="line"><span class="comment">         *     .use(require('webpack-bundle-analyzer').BundleAnalyzerPlugin, [])</span></span><br><span class="line"><span class="comment">         * &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> –&gt;</p>
<h3 id="ssi"><a href="#ssi" class="headerlink" title="ssi"></a>ssi</h3><p>Webpack SSI Include Loader: <a href="https://www.npmjs.com/package/webpack-ssi-include-loader">https://www.npmjs.com/package/webpack-ssi-include-loader</a><br>this package was created to help dev that have to work on with SSI and webpack. it will help for setting a dev environment.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">webpackChain (config) &#123;</span><br><span class="line">    config.module</span><br><span class="line">        .rule(<span class="string">'ssi'</span>)</span><br><span class="line">            .test(<span class="regexp">/\.html$/</span>)</span><br><span class="line">            .use(<span class="string">'html-loader'</span>)</span><br><span class="line">            .loader(<span class="string">'html-loader'</span>)</span><br><span class="line">            .end()</span><br><span class="line">            .use(<span class="string">'ssi-loader'</span>)</span><br><span class="line">            .loader(<span class="string">'webpack-ssi-include-loader'</span>)</span><br><span class="line">            .options(&#123;</span><br><span class="line">                <span class="comment">// localPath: path.resolve(__dirname, '../../sinclude'),</span></span><br><span class="line">                location: <span class="string">'https://app.domain.com/'</span>, <span class="comment">// http url where the file </span></span><br><span class="line">            &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>ssi-compile-webpack-plugin: <a href="https://www.npmjs.com/package/ssi-compile-webpack-plugin">https://www.npmjs.com/package/ssi-compile-webpack-plugin</a><br>静态编译ssi资源<br><!-- PS: 这两个看着差不多。都是2017年左右的 --><br>ssi-mini-webpack-plugin: <a href="https://www.npmjs.com/package/ssi-webpack-plugin/v/1.0.8" target="_blank" rel="noopener">https://www.npmjs.com/package/ssi-webpack-plugin/v/1.0.8</a><br>静态编译ssi资源<p></p>
<h3 id="性能分析"><a href="#性能分析" class="headerlink" title="性能分析"></a>性能分析</h3><p>官方：performance，stats<br><!-- [[你值得拥有的几款实用webpack4性能分析插件【测评与推荐】]](https://juejin.cn/post/6844904040128577549) --></p>
<p>ProgressBarPlugin<br>npm i progress-bar-webpack-plugin</p>
<p>SpeedMeasurePlugin<br>npm i speed-measure-webpack-plugin<br><a href="https://github.com/stephencookdev/speed-measure-webpack-plugin" target="_blank" rel="noopener">https://github.com/stephencookdev/speed-measure-webpack-plugin</a></p>
<p>BundleAnalyzerPlugin<br>npm i webpack-bundle-analyzer</p>
<p>DashboardPlugin<br>npm i webpack-dashboard</p>
<p>DuplicatePackageCheckerPlugin<br>npm i duplicate-package-checker-webpack-plugin</p>
<!-- [浅谈 webpack 性能优化（内附 webpack 学习笔记）](https://zhuanlan.zhihu.com/p/139498741) 
[webpack 学习整理文档](https://github.com/darrell0904/webpack-doc)
-->
<h3 id="忽略一些特定warnings"><a href="#忽略一些特定warnings" class="headerlink" title="忽略一些特定warnings"></a>忽略一些特定warnings</h3><!-- 
taro 多文件跨端埋点，在某一端会少埋点。即缺少export 。但是文件中仍然有import
 -->
<p><code>&quot;export &#39;W_jdgwxcx_BannerExpo&#39; (imported as &#39;wEPoint&#39;) was not found in &#39;@/points/epoint-follow&#39;</code></p>
<h4 id="webpack配置。"><a href="#webpack配置。" class="headerlink" title="webpack配置。"></a>webpack配置。</h4><p>大多是webapck5支持。<br>taro3.4 还没有<code>complie: webpack5</code>(3.6)支持。默认是webpack4.<br>所以配置还是失败了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="comment">// ## 4 难道是devServer 中的配置吗？ build时候没有</span></span><br><span class="line">      devServer: &#123;</span><br><span class="line">            quiet: <span class="literal">true</span>,</span><br><span class="line">            noInfo: <span class="literal">true</span>,</span><br><span class="line">            stats: <span class="string">'errors-only'</span>,</span><br><span class="line">            <span class="comment">// 新版本有的</span></span><br><span class="line">            client: &#123;</span><br><span class="line">                logging: <span class="string">'error'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      webpackChain (chain, webpack) &#123;</span><br><span class="line">            <span class="comment">// chain.plugin('webpackHotMiddleware')</span></span><br><span class="line">            <span class="comment">//     .tap(args =&gt; &#123;</span></span><br><span class="line">            <span class="comment">//         console.log('plugin ', args)</span></span><br><span class="line">            <span class="comment">//          // 该插件这么修改会报错</span></span><br><span class="line">            <span class="comment">//         // args.push(&#123;log: false&#125;)</span></span><br><span class="line">            <span class="comment">//         return [&#123;log: false&#125;]</span></span><br><span class="line">            <span class="comment">//     &#125;)</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="comment">// ## 0 报错不会运行</span></span><br><span class="line">            <span class="comment">// chain.plugin('FilterWarningsPlugin')</span></span><br><span class="line">            <span class="comment">// .use(FilterWarningsPlugin, &#123;</span></span><br><span class="line">            <span class="comment">//     exclude: /export 'W_jdgwxcx_.*was not found in .*/,</span></span><br><span class="line">            <span class="comment">// &#125;)</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// ## 7 清空所有error： `clear:true`。不符合</span></span><br><span class="line">            <span class="comment">// chain.plugin('FriendlyErrorsWebpackPlugin')</span></span><br><span class="line">            <span class="comment">//     .use(FriendlyErrorsWebpackPlugin)</span></span><br><span class="line">            </span><br><span class="line">            chain.merge(&#123;</span><br><span class="line">                <span class="comment">// module: &#123;</span></span><br><span class="line">                <span class="comment">//     // ## 1 webpack5 支持。但是是所有</span></span><br><span class="line">                <span class="comment">//     strictExportPresence: false,</span></span><br><span class="line">                <span class="comment">//     parser: &#123;</span></span><br><span class="line">                <span class="comment">//         javascript: &#123;</span></span><br><span class="line">                <span class="comment">//             reexportExportsPresence: false,</span></span><br><span class="line">                <span class="comment">//             importExportsPresence: false,</span></span><br><span class="line">                <span class="comment">//             exportsPresence: false,</span></span><br><span class="line">                <span class="comment">//         &#125;,</span></span><br><span class="line">                <span class="comment">//     &#125;,</span></span><br><span class="line">                <span class="comment">// &#125;,</span></span><br><span class="line">                <span class="comment">// ## 3 stats 设置，并没有阻止掉dev时候的输出。</span></span><br><span class="line">                stats: &#123;</span><br><span class="line">                    <span class="comment">// ### 3-1</span></span><br><span class="line">                    warnings: <span class="literal">false</span>,</span><br><span class="line">                    <span class="comment">// ### 3-2</span></span><br><span class="line">                    logging: <span class="string">'none'</span>,</span><br><span class="line">                    <span class="comment">// ## 3-3 excludeModules/exclude 设置</span></span><br><span class="line">                    excludeModules: [</span><br><span class="line">                        /ea-point-.*<span class="regexp">/,</span></span><br><span class="line"><span class="regexp">                        /</span>reports\/ea-points\/ea-point-.*<span class="regexp">/,</span></span><br><span class="line"><span class="regexp">                    ],</span></span><br><span class="line"><span class="regexp">                    /</span><span class="regexp">/ ## 2-1 stats.warningsFilter 已被弃用，请改用 ignoreWarnings。</span></span><br><span class="line"><span class="regexp">                    warningsFilter: [</span></span><br><span class="line"><span class="regexp">                        /ea-point-.*/,</span></span><br><span class="line"><span class="regexp">                        /reports\/ea-points\/ea-point-.*/,</span></span><br><span class="line"><span class="regexp">                    ],</span></span><br><span class="line"><span class="regexp">                &#125;,</span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ ### 3-0 </span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ stats: 'errors-only',</span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ ## 2 忽略掉特定的警告。</span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ ignoreWarnings: [</span></span><br><span class="line"><span class="regexp">                //     /ea-point-.*/,</span></span><br><span class="line"><span class="regexp">                //     /reports\/ea-points\/ea-point-.*/,</span></span><br><span class="line"><span class="regexp">                // ],</span></span><br><span class="line"><span class="regexp">            &#125;)</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>FINALLY：解决上面问题(trao 多文件导出)，用了最笨的方式：乖乖的导出。</p>
<h4 id="webpack-filter-warnings-plugin"><a href="#webpack-filter-warnings-plugin" class="headerlink" title="webpack-filter-warnings-plugin"></a>webpack-filter-warnings-plugin</h4><p>webpack-filter-warnings-plugin: <a href="https://github.com/mattlewis92/webpack-filter-warnings-plugin/issues/35" target="_blank" rel="noopener">https://github.com/mattlewis92/webpack-filter-warnings-plugin/issues/35</a></p>
<blockquote>
<p>@iegik Webpack 5 doesn’t need this plugin anymore. You can use ignoreWarnings:</p>
</blockquote>
<p>PS: taro3.4 的版本中失效了。应该是指定的webapck 版本才支持。 用webpack chain 的写法，运行失败了。<br><!-- [Fix warn chunk commons [mini-css-extract-plugin] error in Gatsby JS](https://robertmarshall.dev/blog/fix-warn-chunk-commons-mini-css-extract-plugin-error-in-gatsby-js/) --><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FilterWarningsPlugin = <span class="built_in">require</span>(<span class="string">"webpack-filter-warnings-plugin"</span>);</span><br><span class="line"></span><br><span class="line">exports.onCreateWebpackConfig = <span class="function">(<span class="params">&#123; actions &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  actions.setWebpackConfig(&#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="keyword">new</span> FilterWarningsPlugin(&#123;</span><br><span class="line">        exclude:</span><br><span class="line">          /mini-css-extract-plugin[^]*Conflicting order. Following <span class="built_in">module</span> has been added:<span class="regexp">/,</span></span><br><span class="line"><span class="regexp">      &#125;),</span></span><br><span class="line"><span class="regexp">    ],</span></span><br><span class="line"><span class="regexp">  &#125;);</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="FriendlyErrorsWebpackPlugin"><a href="#FriendlyErrorsWebpackPlugin" class="headerlink" title="FriendlyErrorsWebpackPlugin"></a>FriendlyErrorsWebpackPlugin</h4><p>friendly-errors-webpack-plugin: <a href="https://www.npmjs.com/package/friendly-errors-webpack-plugin" target="_blank" rel="noopener">https://www.npmjs.com/package/friendly-errors-webpack-plugin</a><br><!-- [清理webpack编译时输出的无用信息](https://blog.csdn.net/FAITHZK/article/details/80919424) --><br><!-- 最近在使用webpack重新搭建项目，在启动了webpack之后发现在终端输出了很多信息，看着很别扭，效果如下： --><br>于是参考了vue-cli的配置，使用FriendlyErrorsWebpackPlugin插件来解决这个问题<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FriendlyErrorsWebpackPlugin = <span class="built_in">require</span>(<span class="string">'friendly-errors-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">      quiet: <span class="literal">true</span>, <span class="comment">// 如果使用webpack-dev-server，需要设为true，禁止显示devServer的console信息</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> FriendlyErrorsWebpackPlugin(&#123;</span><br><span class="line">            compilationSuccessInfo: &#123;</span><br><span class="line">                messages: [<span class="string">`Your application is running here: <span class="subst">$&#123;config.dev.https ? <span class="string">'https'</span> : <span class="string">'http'</span>&#125;</span>://<span class="subst">$&#123;config.dev.host&#125;</span>:<span class="subst">$&#123;config.dev.port&#125;</span>`</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            onErrors: config.dev.notifyOnErrors</span><br><span class="line">                ? utils.createNotifierCallback()</span><br><span class="line">                : <span class="literal">undefined</span>,</span><br><span class="line">            clearConsole: <span class="literal">true</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="mini-css-extract-plugin"><a href="#mini-css-extract-plugin" class="headerlink" title="mini-css-extract-plugin"></a>mini-css-extract-plugin</h3><p><code>Conflicting order. Following module has been added:</code><br>此警告意思为在不同的js中引用相同的css时，先后顺序不一致。也就是说，在1.js中先后引入a.css和b.css，而在2.js中引入的却是b.css和a.css，此时会有这个warning。</p>
<p>直接修改顺序可以避免这个警告，但是后期所有的文件顺序都得按照这个来，有些繁琐。<br>增加ignoreOrder: true配置，如：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    ignoreOrder: <span class="literal">true</span></span><br><span class="line">&#125;),</span><br><span class="line"><span class="comment">// webpack chain</span></span><br><span class="line">webpackChain (chain) &#123;</span><br><span class="line">    chain.plugin(<span class="string">'miniCssExtractPlugin'</span>)</span><br><span class="line">        .tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">            args[<span class="number">0</span>].ignoreOrder = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">return</span> args</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<!-- [Fix warn chunk commons [mini-css-extract-plugin] error in Gatsby JS](https://robertmarshall.dev/blog/fix-warn-chunk-commons-mini-css-extract-plugin-error-in-gatsby-js/) -->
<!-- 
[Conflicting order. Following module has been added:](https://blog.csdn.net/qianxing111/article/details/107379683)
[Conflicting order. Following module has been added](https://www.cxyzjd.com/article/qianxing111/107379683) 
-->
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><ol>
<li><code>Conflicting order. Following module has been added:</code><br>见插件：mini-css-extract-plugin</li>
</ol>
<p style="text-align:right"> </p>


      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>knowledge is no pay,reward is kindness</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="Yalhu 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Yalhu 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/webpack/" rel="tag"><i class="fa fa-tag"></i> webpack</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/w3/git/git文档/git文档 10 - Git 内部原理/" rel="next" title="Git文档10 - Git 内部原理">
                <i class="fa fa-chevron-left"></i> Git文档10 - Git 内部原理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/sum/jsplus/webpack原理/" rel="prev" title="Webpack原理">
                Webpack原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="//www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/robbot.jpg" alt="Yalhu">
            
              <p class="site-author-name" itemprop="name">Yalhu</p>
              <p class="site-description motion-element" itemprop="description">no better,but great !</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">395</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">46</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:xxxx@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="/home2/" title="Home2" target="_blank">Home2</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/archives2/" title="Archives2" target="_blank">Archives2</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/acategories/" title="Acategories" target="_blank">Acategories</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        
          <style>
            .post-toc .nav .nav-child { display: block; }
          </style>
        
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#webpack-chain"><span class="nav-text">webpack-chain</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置"><span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#public-path"><span class="nav-text">public path</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#插件"><span class="nav-text">插件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#terser-webpack-plugin"><span class="nav-text">terser-webpack-plugin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#html-webpack-plugin"><span class="nav-text">html-webpack-plugin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#性能分析"><span class="nav-text">性能分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#忽略一些特定warnings"><span class="nav-text">忽略一些特定warnings</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack配置。"><span class="nav-text">webpack配置。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-filter-warnings-plugin"><span class="nav-text">webpack-filter-warnings-plugin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FriendlyErrorsWebpackPlugin"><span class="nav-text">FriendlyErrorsWebpackPlugin</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mini-css-extract-plugin"><span class="nav-text">mini-css-extract-plugin</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#问题"><span class="nav-text">问题</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yalhu</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">653.5k</span>
  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'yalhu',
            repo: 'ablobComment',
            
            lang: "zh-Hans" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: 'e2dffa7f47b9523021b9ae56b08f1a8901ec5b47',
            
                client_id: '55b918d3485e51d807dd'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("FR1Ck8VBxN9d1lKPIOSKmvgl-gzGzoHsz", "bLUjHdwtJTf00J8OwVTT8urs");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
